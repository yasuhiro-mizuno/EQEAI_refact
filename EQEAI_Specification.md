
# 表現品質評価AI 仕様書

## 概要
「表現品質評価AI」は、生成AIや自然言語処理（NLP）技術を活用して、要件仕様書の表現品質を評価するソリューションである。ユーザーが指定した表現品質ルールに基づき、文書内の要求文を抽出・評価し、改善案を提示する。

## 入力形式
- Word（.docx）ファイル
- PDF（.pdf）ファイル

## 処理手順
1. 入力ファイルを読み込み、章番号・章名を抽出
2. 文書をLLMが1文単位に分割
3. ユーザーが選択した表現品質ルールに基づき、LLMが各ソフトウェア要求文を評価
4. 評価結果をMarkdown形式の表で出力

## 文章分割
- 文書はLLMを用いて1文単位に分割すること。
- 分割した文から、ソフトウェア要求が書かれている文だけをLLMで抽出すること。
- 分割した結果、文とみなせないものは除外すること。
- ソフトウェア要求文だけを表現品質評価にかけること。

### LLMに与えるプロンプトの条件
- 表現品質ルールのどれに該当したかを出力するようにさせること。
- 該当の表現品質ルールを順守できるような改善案を1つ提案させること。

### 表現品質評価ルール（ユーザー選択可能）
#### 簡潔な文
- 能動的な表現で要求を記述していること。
- 例えば、以下の表現を使用していないこと。：
  - 受動態（例：送信される）
  - 二重否定（例：判定しないことはしない）
  - 部分否定（例：全てを処理しないわけではない）
  - 使役表現（例：書き込ませる）

#### 必要な語の欠落
- 要求の主体や処理の対象が明確であること。
- 主語、述語、目的語がすべて記述されていること。

#### 曖昧語の回避
- 曖昧性の高い表現（例：適切に、可能な限り）を使用していないこと。

#### 誤字脱字
- 誤字や脱字がないこと。

#### 係り受け
- 係り受けが一意に解釈できること。

## 出力形式
- Markdown形式の表で以下の項目を出力すること。：

| 章番号・章名 | 元の記述 | 指摘理由 | 改善案 |
|--------------|-----------|-----------|---------|
| 1.2 要求仕様 | ユーザーにより送信される | 簡潔な文: 受動態「送信される」が使用されています | ユーザーが送信する |
| 2.1 処理概要 | 適切に処理すること | 曖昧語の回避: 「適切に」が曖昧です | モジュールAで処理すること |
| 3.3 エラー処理 | エラーが発生しないことはない | 簡潔な文: 二重否定が使用されています | エラーが発生する可能性がある |

- 出力は表現品質ルールに該当した文だけとすること。

## ユーザー操作
- 評価対象の表現品質ルールを選択できるようにすること。
- 評価結果をMarkdown形式でダウンロードできるようにすること。

## 使用技術
- Python
- NLPライブラリ（spaCy、transformersなど）
- 文書解析ライブラリ（python-docx、PyMuPDF）

## Azure OpenAI 設定

このソリューションでは、Azure OpenAI を使用して表現品質評価を行うこと。

### 使用モデル
- デプロイメント名：`o4-mini`
- Azure OpenAI では、OpenAI の `model` パラメータではなく、**`deployment_name`** を使用してモデルを指定する。

### 認証と接続設定
- 認証情報は `.env` ファイルから読み込みむようにすること。
- 必要な環境変数は以下の通りである。：

```env
AZURE_OPENAI_API_KEY=your_api_key_here
AZURE_OPENAI_ENDPOINT=https://your-resource-name.openai.azure.com/
AZURE_OPENAI_VERSION=your_api_version_here
```

## 追加仕様

本ソリューションでは、以下の追加仕様を満たすように設計・実装を行うこと。

### エラーの対処
- Azure OpenAIのAPIやコード実行でエラーが出た場合、エラー内容をそのまま出力できるように数すること。

### READMEの作成
- 必要なライブラリ、環境構築手順、実行方法、使用例などを記載した `README.md` を作成すること。
- READMEには以下の内容を含めること。：
  - フォルダ構成
  - 必要なPythonライブラリ（例：`python-docx`, `PyMuPDF`, `spaCy`, `transformers`, `dotenv` など）
  - `.env` ファイルの設定方法
  - 実行手順（例：ローカル環境での起動方法、UIの起動方法）
  - 使用例（入力ファイルと出力結果の例）

### Requirements.txtの作成
- 実行するにあたって必要なモジュールをリスト化し、pip install -r Requirements.txtでインストールできるようにすること。

### ユーザーインターフェース（UI）の提供
- ターミナルベースの操作ではなく、streamlitを使ってWebベースのUIを提供すること。
- UIは以下の機能を備えること。：
  - Word/PDFファイルのアップロード
  - 表現品質ルールの選択（チェックボックス形式）
  - 評価を開始するための「評価」ボタンをUI上に設置すること。
  - ユーザーが処理中であることを認識できるように、UI上に動的な表示（例：ローディングインジケーター、進捗バー、アニメーションなど）を表示すること。
  - 評価結果の表示（Markdown表形式）
  - 評価結果のダウンロード（MarkdownまたはCSV形式）